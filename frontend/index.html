<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF Print Saver</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      #dropZone.hover {
        border-color: #4f46e5;
        background: #eef2ff;
      }
    </style>
  </head>

  <body class="bg-gray-100">
    <div class="max-w-xl mx-auto mt-20 p-6 bg-white rounded-2xl shadow-lg">
      <h1 class="text-3xl font-bold text-gray-900 text-center mb-4">
        PDF Print Saver
      </h1>
      <p class="text-gray-600 text-center mb-8">
        Convert any PDF into
        <span class="font-semibold text-indigo-600"
          >2-UP Cut & Stack format</span
        >.<br />
        Print books 75% cheaper â€” just upload & download.
      </p>

      <!-- Drop Zone -->
      <div
        id="dropZone"
        class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center cursor-pointer transition"
      >
        <p class="text-gray-500 mb-2">Drag & drop your PDF here</p>
        <p class="text-sm text-gray-400">or click to select manually</p>
        <input
          type="file"
          id="pdfFile"
          accept="application/pdf"
          class="hidden"
        />
      </div>

      <button
        id="generateBtn"
        class="w-full mt-6 bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-xl font-semibold transition"
      >
        Generate Print-Ready PDF
      </button>

      <p id="status" class="text-center text-sm text-gray-600 mt-4"></p>
    </div>

    <script>
      const dropZone = document.getElementById("dropZone");
      const fileInput = document.getElementById("pdfFile");
      const generateBtn = document.getElementById("generateBtn");
      const statusText = document.getElementById("status");

      dropZone.addEventListener("click", () => fileInput.click());

      // Drag-hover styling
      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("hover");
      });
      dropZone.addEventListener("dragleave", () => {
        dropZone.classList.remove("hover");
      });
      dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("hover");
        fileInput.files = e.dataTransfer.files;
      });

      generateBtn.addEventListener("click", async () => {
        if (!fileInput.files.length) {
          statusText.textContent = "Please upload a PDF first.";
          statusText.classList.add("text-red-500");
          return;
        }

        statusText.textContent = "Processing... Please wait.";
        statusText.classList.remove("text-red-500");
        statusText.classList.add("text-indigo-600");

        const file = fileInput.files[0];
        const formData = new FormData();
        formData.append("file", file);

        // CHANGE THIS AFTER DEPLOYMENT
        const backendURL = "https://print-pdf-cheap.onrender.com/impose";


        const res = await fetch(backendURL, {
          method: "POST",
          body: formData,
        });

        const blob = await res.blob();
        const url = window.URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = "output.pdf";
        a.click();

        window.URL.revokeObjectURL(url);
        statusText.textContent = "Done! Your PDF has been downloaded.";
        statusText.classList.remove("text-indigo-600");
        statusText.classList.add("text-green-600");
      });
    </script>
  </body>
</html>
